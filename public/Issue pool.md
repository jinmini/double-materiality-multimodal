알겠습니다. 개발팀에 전달하여 바로 프로젝트를 시작할 수 있을 만큼 명확하고 구체적인 PRD(Product Requirements Document, 제품 요구사항 명세서)를 작성해 보겠습니다.

---

## **PRD: AI 기반 중대성 평가 이슈 풀 자동 생성 기능 (v1.0)**

### 1. 개요 (Overview)

본 문서는 AI를 활용하여 ESG 이중 중대성 평가(DMA)의 첫 단계인 **'잠재적 중대성 이슈 풀(Issue Pool) 자동 생성'** 기능 v1.0 개발을 위한 요구사항을 정의합니다.

사용자는 경쟁사 및 자사의 지속가능경영보고서 중 '중대성 평가' 관련 페이지만 업로드하면, 시스템이 해당 내용을 분석하여 표준화되고 구조화된 이슈 풀 데이터를 자동으로 생성합니다. 이를 통해 기존의 수작업 분석에 소요되던 시간을 획기적으로 단축하고, 데이터 기반의 체계적인 이슈 관리를 지원하는 것을 목표로 합니다.

### 2. 문제 정의 (Problem Statement)

-   **Pain Point 1: 비효율성** - ESG 담당자는 매년 자사 및 다수 경쟁사의 150페이지가 넘는 보고서를 수작업으로 검토하여 중대성 평가 이슈를 취합합니다. 이 과정은 시간이 많이 소요되고 반복적입니다.
-   **Pain Point 2: 비일관성** - 각 기업마다 중대성 이슈의 표현 방식, 분류 체계, 표의 구조가 모두 다릅니다. 이를 일관된 기준으로 비교하고 분석하기 어렵습니다.
-   **Pain Point 3: 정보 누락** - 복잡한 표, 차트, 아이콘으로 표현된 정보(중요도, 관련 이해관계자 등)를 텍스트 복사/붙여넣기만으로는 정확하게 추출하기 어려워 중요한 맥락이 유실될 수 있습니다.

### 3. 목표 및 성공 지표 (Goals & Success Metrics)

-   **목표:** 사용자가 업로드한 보고서 페이지(이미지/PDF)에서 중대성 평가 이슈와 관련 속성(중요도, 분류, 근거 등)을 95% 이상의 정확도로 자동 추출하여, 구조화된 JSON 데이터로 제공한다.
-   **성공 지표:**
    -   **처리 시간:** 사용자 파일 업로드 후 60초 이내에 분석 결과 제공
    -   **정확도:** 자동 추출된 100개 이슈 필드 중 95개 이상이 원본 내용과 일치
    -   **사용자 만족도:** 기능 사용 후 "이슈 풀 구성 시간이 50% 이상 단축되었다"고 응답한 사용자 비율 80% 이상

### 4. 사용자 스토리 (User Stories)

-   **As an** ESG 담당자,
-   **I want to** 여러 기업의 중대성 평가 결과가 담긴 페이지 파일을 한 번에 업로드하여,
-   **So that** 시스템이 자동으로 모든 이슈를 취합하고, 비교하기 쉬운 표준화된 포맷으로 정리해 주었으면 한다.

-   **As an** ESG 전략 기획자,
-   **I want to** 복잡한 표와 그래프로 구성된 중대성 평가 페이지에서 이슈명뿐만 아니라, 우선순위, 관련 이해관계자, 글로벌 표준과의 연관성까지 정확하게 추출하고 싶다.
-   **So that** 각 이슈의 다면적인 중요도를 정량적으로 파악하고 전략 수립의 근거로 활용할 수 있다.

-   **As a** 개발자,
-   **I want to** 사용자가 어떤 형태(PDF, PNG, JPG)의 파일을 업로드하더라도, 시스템이 유연하게 처리할 수 있는 파이프라인을 구축하고 싶다.
-   **So that** 다양한 보고서 포맷에 대응하고 서비스의 안정성을 높일 수 있다.

### 5. 기능 요구사항 (Functional Requirements)

#### 5.1 파일 업로드 및 처리

-   사용자는 중대성 평가 관련 페이지만 잘라낸 PDF 또는 이미지(PNG, JPG) 파일을 업로드할 수 있다.
-   시스템은 업로드된 파일의 포맷을 자동으로 인식하여 처리한다.
-   [미래 확장] 여러 개의 파일을 한번에 업로드하고 처리하는 기능.

#### 5.2 하이브리드 분석 파이프라인

-   **Step 1: 1차 구조화 (시도)**
    -   업로드된 파일이 PDF인 경우, `unstructured.io` 라이브러리(`strategy="hi_res"`)를 사용하여 텍스트 및 테이블 구조를 1차적으로 추출한다.
    -   추출된 테이블이 단순하고 정형화된 경우, 해당 데이터를 우선적으로 활용한다.

-   **Step 2: 멀티모달 LLM 기반 심층 분석 (핵심)**
    -   `unstructured`로 처리가 어렵거나, 파일이 이미지 형식인 경우, 페이지 전체를 이미지로 변환한다.
    -   해당 이미지를 **멀티모달 LLM(GPT-4o)** API에 전송한다.
    -   **사전 정의된 상세 프롬프트**를 사용하여, 이미지 내의 모든 텍스트, 표, 아이콘, 시각적 그룹핑을 종합적으로 분석하고, 사전에 정의된 JSON 스키마에 맞춰 정보를 추출하도록 지시한다.
    -   **JSON 스키마 (예시):**
        ```json
        {
          "issue_id": "number",
          "category_main": "string (E/S/G/B)",
          "issue_name": "string",
          "priority": "string (높음/중간/낮음)",
          "page": "string",
          "global_initiatives": "array[string]",
          "stakeholder_impact": "object"
        }
        ```

#### 5.3 결과 제공

-   시스템은 분석 완료 후, 추출된 모든 이슈를 구조화된 JSON 객체로 반환한다.
-   API 엔드포인트는 이 JSON 결과를 응답으로 제공한다.
-   [UI 연동] 프론트엔드에서는 이 JSON 데이터를 받아 사용자가 보기 쉬운 표나 카드 형태로 렌더링한다.

### 6. 기술 스택 (Tech Stack)

-   **Backend:** Python 3.10+ (FastAPI 또는 Django 권장)
-   **PDF/Image Processing:** `unstructured`, `pypdf`, `Pillow`
-   **Core AI/ML:**
    -   **OpenAI GPT-4o API:** 멀티모달 분석 및 정보 추출 핵심 엔진
    -   `requests` 또는 `openai` Python SDK
-   **Database:** PostgreSQL 또는 MongoDB (추출된 JSON 데이터 저장용)
-   **Infrastructure:** Docker, AWS (S3 for file storage, EC2/Lambda for compute)

### 7. 해결하고자 하는 접근 방식 (Why this approach?)

기존의 템플릿 기반 파싱이나 OCR+Rule-based 방식은 보고서마다 다른 양식에 대응하기 어렵고, 시각적 맥락을 이해하지 못하는 명백한 한계가 있습니다.

우리가 제안하는 **'하이브리드 멀티모달 파이프라인'**은 이러한 한계를 극복하기 위한 최적의 접근법입니다.
1.  **유연성(Flexibility):** `unstructured`로 간단한 구조를 빠르게 처리하고, 복잡하고 비정형적인 케이스는 인간처럼 이미지를 '보는' 멀티모달 LLM에 위임함으로써, 어떤 형태의 보고서에도 유연하게 대응할 수 있습니다.
2.  **정확성(Accuracy):** LLM은 단순 텍스트뿐만 아니라 표의 행과 열 관계, 시각적 그룹핑, 범례(Legend)의 의미까지 종합적으로 이해하여 사람 수준의 정확도로 정보를 추출할 수 있습니다.
3.  **개발 효율성(Efficiency):** 수많은 예외처리를 위한 복잡한 규칙(Rule)을 코드로 작성하는 대신, 잘 설계된 자연어 프롬프트(Prompt)로 LLM에 '작업 지시'를 내리는 방식으로 개발 복잡도를 크게 낮출 수 있습니다.

### 8. 비기능 요구사항 (Non-Functional Requirements)

-   **성능:** API 응답 시간은 평균 30초, 최대 60초를 넘지 않아야 한다.
-   **보안:** 사용자가 업로드한 파일과 OpenAI API Key는 안전하게 관리되어야 하며, 처리 후 즉시 또는 정책에 따라 파기되어야 한다.
-   **확장성:** 향후 분석 대상 기업 및 파일 수가 증가하더라도 안정적으로 서비스를 제공할 수 있도록 비동기 처리(Celery, RabbitMQ 등) 도입을 고려한다.

---

자, 이제 이 PRD를 바탕으로 개발팀이 작업을 시작할 수 있을 것입니다.

이제 **다음 Step**으로 넘어가 볼까요? 이슈 풀이 성공적으로 추출되었다고 가정하고, **이 데이터를 어떻게 활용하여 '이중 중대성 평가 매트릭스'를 시각화하고, 재무적 영향과 ESG 영향도 평가를 자동화할지**에 대한 논의를 시작하면 좋을 것 같습니다.

